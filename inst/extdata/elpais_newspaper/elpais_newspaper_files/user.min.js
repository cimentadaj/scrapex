var PRISA=PRISA||{},conflictFirefoxVersion=102;!function(f){"use strict";var i=!1,j=!1,k=[],l="//pxlctl.elpais.com/pxlctl.gif?m=1",c=-1,b={data:{uid:void 0,nickname:void 0,nombre:void 0,apellido1:void 0,nombre_bonito:void 0,avatar:void 0},dataWsUserInfo:{status:-1,id:{uid:void 0,nick:void 0,ts:void 0,nom:void 0,ap1:void 0,nb:void 0,avat:void 0}},init:function(b){var c=parseInt(1e7*Math.random()),a=new Image(1,1),d=this;1==b?a.src=l+"&w="+c:a.src=l+"&r="+b+"&w="+c,j=window.setTimeout(function(){j=!1,d.callListeners()},2e3),a.onload=function(){j&&(window.clearTimeout(j),d.callListeners())}},getData:function(a){return a&&"ws"==a?this.dataWsUserInfo:this.data},addListener:function(b,a,c){i?b.call(c,a&&"ws"==a?this.dataWsUserInfo:this.data):k.push({f:b,fmt:a,obj:c})},callListeners:function(){this.loadData(),i=!0,k.forEach(function(a){a.f.call(a.obj,a.fmt&&"ws"==a.fmt?this.dataWsUserInfo:this.data)},this)},loadData:function(){for(var f,g=!1,h=decodeURIComponent(document.cookie).split(";"),d=0;d<h.length;d++)if("uid_ns="==(f=h[d].trim()).substr(0,7)){g=!0;break}if(g){var b=f.substr(7).split("#");if(this.data.uid=b[0],this.data.nickname=b[1],this.dataWsUserInfo.status=1,this.dataWsUserInfo.id.uid=this.data.uid,this.dataWsUserInfo.id.nick=this.data.nickname,window.PEPuid=this.data.uid,window.PEPuname=this.data.nickname,b[3]){for(var a=[],e=b[3].match(/:[^|]+|[^:]+/g),c=0;c<e.length;c+=2)a[e[c]]=e[c+1].substr(1);this.data.nombre=this.decodeBase64ToUTF8(a[":NOM"]),this.data.apellido1=this.decodeBase64ToUTF8(a[":AP1"]),this.data.nombre_bonito=this.decodeBase64ToUTF8(a[":NB"]),this.data.avatar=this.getAvatar(this.data.nickname),this.dataWsUserInfo.id.nom=a[":NOM"],this.dataWsUserInfo.id.ap1=a[":AP1"],this.dataWsUserInfo.id.nb=a[":NB"],this.dataWsUserInfo.id.ts=a[":TS"],this.dataWsUserInfo.id.avat=this.data.avatar}}},decodeBase64ToUTF8:function(a){if(!a||""==a)return"";var h,f,c,g,d=[],e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");b<a.length&&(h=e.indexOf(a[b++]),f=e.indexOf(a[b++]),c=e.indexOf(a[b++]),g=e.indexOf(a[b++]),d.push(h<<2|f>>4),64!=c)&&(d.push((15&f)<<4|c>>2),64!=g);)d.push((3&c)<<6|g);return this.decodeBase64(d)},decodeBase64:function(b){for(var a,d,f,e="",c=0;c<b.length;)128>(a=b[c++])?e+=String.fromCharCode(a):191<a&&a<224?(d=b[c++],e+=String.fromCharCode((31&a)<<6|63&d)):(d=b[c++],f=b[c++],e+=String.fromCharCode((15&a)<<12|(63&d)<<6|63&f));return e},getAvatar:function(a){if(!a||""==a)return"";for(var e=[0,0],b=0;b<a.length;b++)e[b%2]+=a[b].charCodeAt(0);for(var c=(e[0]%16).toString(16).toUpperCase();c.length<1;)c="0"+c;for(var d=(e[1]%256).toString(16).toUpperCase();d.length<2;)d="0"+d;return"/miperfil/avatares/"+c+"/"+d+"/"+a+".jpg"},trackAgain:function(){if(!(c<0)){var a=parseInt(1e7*Math.random()),b=new Image(1,1);1==c?b.src=l+"&w="+a:b.src=l+"&r="+c+"&w="+a}}};b.loadData();var d=document.getElementsByTagName("script"),g=d[d.length-1],e=/i=(\d+)/.exec(g.src),a=navigator.userAgent.match(/Firefox\/(\d+)/),h=null!==a&&("object"==typeof a||"array"==typeof a)&&a[1]?parseInt(a[1],10):0;e&&h<conflictFirefoxVersion&&(c=e[1],b.init(c)),f.user=b}(PRISA)
